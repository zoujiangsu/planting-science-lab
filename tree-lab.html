<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>植树问题科学探索园</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
        }
        
        body {
            background-color: #f0f9ff;
            color: #2d5016;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: radial-gradient(#c1e5c0 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #ffde59;
            border-radius: 20px;
            box-shadow: 0 8px 0 #ffb300;
            border: 5px solid #fff;
            position: relative;
        }
        
        h1 {
            font-size: 2.8rem;
            color: #2a7d3e;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0 #ffde59;
        }
        
        .subtitle {
            font-size: 1.5rem;
            color: #4a9c5f;
            font-weight: bold;
        }
        
        .scientist-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #2a7d3e;
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .space-container {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            grid-template-rows: auto auto;
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .space-area {
            background-color: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border: 5px solid;
            transition: transform 0.3s ease;
        }
        
        .space-area:hover {
            transform: translateY(-5px);
        }
        
        .area-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 4px dashed;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* 入口区样式 */
        #entrance-area {
            grid-column: 1;
            grid-row: 1;
            border-color: #4a9c5f;
            background-color: #e8f5e9;
        }
        
        #entrance-area .area-title {
            color: #2a7d3e;
            border-bottom-color: #4a9c5f;
        }
        
        /* 核心探索区样式 */
        #exploration-area {
            grid-column: 2;
            grid-row: 1 / span 2;
            border-color: #ff9800;
            background-color: #fff3e0;
            min-height: 600px;
        }
        
        #exploration-area .area-title {
            color: #ff6f00;
            border-bottom-color: #ff9800;
        }
        
        /* 工具区样式 */
        #tools-area {
            grid-column: 3;
            grid-row: 1;
            border-color: #2196f3;
            background-color: #e3f2fd;
        }
        
        #tools-area .area-title {
            color: #0d47a1;
            border-bottom-color: #2196f3;
        }
        
        /* 成果展示区样式 */
        #results-area {
            grid-column: 1 / span 2;
            grid-row: 2;
            border-color: #9c27b0;
            background-color: #f3e5f5;
        }
        
        #results-area .area-title {
            color: #7b1fa2;
            border-bottom-color: #9c27b0;
        }
        
        /* 交互元素样式 */
        .interactive-zone {
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .problem-type {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .type-btn {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 0 #2e7d32;
        }
        
        .type-btn:hover {
            background-color: #388e3c;
            transform: translateY(-3px);
        }
        
        .type-btn.active {
            background-color: #ff9800;
            box-shadow: 0 4px 0 #f57c00;
        }
        
        .tree-planting-area {
            width: 100%;
            height: 300px;
            background-color: #d7ccc8;
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            border: 5px solid #8d6e63;
        }
        
        .road {
            position: absolute;
            background-color: #8d6e63;
            height: 20px;
            border-radius: 10px;
        }
        
        .tree {
            position: absolute;
            width: 40px;
            height: 50px;
            cursor: pointer;
            transition: transform 0.2s;
            z-index: 10;
        }
        
        .tree:hover {
            transform: scale(1.2);
        }
        
        .tree-trunk {
            position: absolute;
            width: 10px;
            height: 30px;
            background-color: #8d6e63;
            bottom: 0;
            left: 15px;
            border-radius: 5px 5px 0 0;
        }
        
        .tree-crown {
            position: absolute;
            width: 40px;
            height: 30px;
            background-color: #4caf50;
            top: 0;
            border-radius: 50%;
        }
        
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
            justify-content: center;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .control-label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #2a7d3e;
        }
        
        .slider {
            width: 200px;
            margin: 5px 0;
        }
        
        .counter {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff6f00;
            background-color: white;
            padding: 5px 15px;
            border-radius: 10px;
            border: 3px solid #ff9800;
        }
        
        .tool-item {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 5px solid #2196f3;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tool-item:hover {
            background-color: #bbdefb;
            transform: translateX(5px);
        }
        
        .formula-box {
            background-color: #ffecb3;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 1.2rem;
            text-align: center;
            border: 2px dashed #ffb300;
        }
        
        .result-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
            border-top: 8px solid #9c27b0;
        }
        
        .result-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #7b1fa2;
            margin: 10px 0;
        }
        
        .achievement-badge {
            display: inline-block;
            background-color: #ffde59;
            color: #2a7d3e;
            padding: 8px 15px;
            border-radius: 50px;
            margin: 10px 5px;
            font-weight: bold;
            border: 3px solid #ffb300;
        }
        
        .tree-count-display {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: #2a7d3e;
        }
        
        .scientist-tip {
            background-color: #e1f5fe;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border-left: 5px solid #03a9f4;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #4a9c5f;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        /* 响应式调整 */
        @media (max-width: 1024px) {
            .space-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }
            
            #entrance-area { grid-column: 1; grid-row: 1; }
            #exploration-area { grid-column: 1; grid-row: 2; }
            #tools-area { grid-column: 1; grid-row: 3; }
            #results-area { grid-column: 1; grid-row: 4; }
            
            .result-display {
                grid-template-columns: 1fr;
            }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .celebrate {
            animation: celebrate 0.5s ease;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(-5deg); }
            50% { transform: scale(1.2) rotate(5deg); }
            75% { transform: scale(1.2) rotate(-5deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>植树问题科学探索园</h1>
            <p class="subtitle">像科学家一样探索植树问题的奥秘！</p>
            <div class="scientist-badge">
                <i class="fas fa-microscope"></i>
                <span>小小植树科学家</span>
            </div>
        </header>
        
        <div class="space-container">
            <!-- 入口区 -->
            <div id="entrance-area" class="space-area">
                <h2 class="area-title"><i class="fas fa-door-open"></i> 探索入口区</h2>
                <p>欢迎来到植树问题科学探索园！在这里，你将扮演植树科学家，探索不同场景下的植树规律。</p>
                
                <div class="interactive-zone">
                    <h3><i class="fas fa-seedling"></i> 植树问题是什么？</h3>
                    <p>植树问题就是研究在一定长度的路线上植树时，<strong>树的棵数</strong>与<strong>间隔数</strong>之间的关系。</p>
                    <p>主要分为三种情况：</p>
                    <ul>
                        <li><strong>两端都栽</strong>：棵数 = 间隔数 + 1</li>
                        <li><strong>只栽一端</strong>：棵数 = 间隔数</li>
                        <li><strong>两端不栽</strong>：棵数 = 间隔数 - 1</li>
                    </ul>
                    <p>点击下方按钮选择你要探索的问题类型：</p>
                    
                    <div class="problem-type">
                        <button class="type-btn active" data-type="both">两端都栽</button>
                        <button class="type-btn" data-type="one">只栽一端</button>
                        <button class="type-btn" data-type="none">两端不栽</button>
                    </div>
                </div>
                
                <div class="scientist-tip">
                    <i class="fas fa-lightbulb"></i> <strong>科学家提示：</strong> 先确定问题类型，再选择路长和间隔，最后观察规律！
                </div>
            </div>
            
            <!-- 核心探索区 -->
            <div id="exploration-area" class="space-area">
                <h2 class="area-title"><i class="fas fa-search"></i> 核心探索区</h2>
                <p>在这里你可以创建自己的植树场景，并观察植树规律！</p>
                
                <div class="tree-count-display">
                    当前已种植：<span id="tree-count">0</span> 棵树
                </div>
                
                <div class="tree-planting-area" id="planting-area">
                    <!-- 树将通过JavaScript动态生成 -->
                </div>
                
                <div class="control-panel">
                    <div class="control-group">
                        <div class="control-label">路线长度：<span id="road-length-value">100</span>米</div>
                        <input type="range" min="50" max="200" value="100" class="slider" id="road-length">
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">间隔距离：<span id="interval-value">10</span>米</div>
                        <input type="range" min="5" max="30" value="10" class="slider" id="interval">
                    </div>
                    
                    <div class="control-group">
                        <button id="plant-trees-btn" class="type-btn pulse">
                            <i class="fas fa-tree"></i> 开始植树！
                        </button>
                    </div>
                </div>
                
                <div class="formula-box">
                    <div id="formula-text">请先选择问题类型并设置参数</div>
                </div>
            </div>
            
            <!-- 工具/资源区 -->
            <div id="tools-area" class="space-area">
                <h2 class="area-title"><i class="fas fa-tools"></i> 科学工具区</h2>
                <p>使用这些科学工具来帮助你探索植树问题：</p>
                
                <div class="tool-item" id="tool-ruler">
                    <h3><i class="fas fa-ruler"></i> 间隔测量器</h3>
                    <p>点击测量两个树之间的间隔距离</p>
                </div>
                
                <div class="tool-item" id="tool-calculator">
                    <h3><i class="fas fa-calculator"></i> 植树计算器</h3>
                    <p>输入路长和间隔，自动计算可植树数量</p>
                </div>
                
                <div class="tool-item" id="tool-notebook">
                    <h3><i class="fas fa-book"></i> 科学观察笔记</h3>
                    <p>记录你的发现和规律</p>
                </div>
                
                <div class="tool-item" id="tool-magnifier">
                    <h3><i class="fas fa-search-plus"></i> 规律放大镜</h3>
                    <p>高亮显示植树规律</p>
                </div>
                
                <div class="scientist-tip">
                    <i class="fas fa-lightbulb"></i> <strong>科学家提示：</strong> 使用"间隔测量器"可以直观看到树与树之间的距离！
                </div>
            </div>
            
            <!-- 成果展示区 -->
            <div id="results-area" class="space-area">
                <h2 class="area-title"><i class="fas fa-trophy"></i> 成果展示区</h2>
                <p>你的科学探索成果将在这里展示：</p>
                
                <div class="result-display">
                    <div class="result-card">
                        <h3>间隔数</h3>
                        <div class="result-value" id="interval-count">0</div>
                        <p>路线长度 ÷ 间隔距离</p>
                    </div>
                    
                    <div class="result-card">
                        <h3>植树棵数</h3>
                        <div class="result-value" id="tree-result">0</div>
                        <p>根据问题类型计算</p>
                    </div>
                    
                    <div class="result-card">
                        <h3>探索得分</h3>
                        <div class="result-value" id="score">0</div>
                        <p>完成探索获得分数</p>
                    </div>
                </div>
                
                <div class="achievement-container">
                    <h3>获得的科学成就：</h3>
                    <div id="achievements">
                        <span class="achievement-badge">植树新手</span>
                    </div>
                </div>
                
                <div class="scientist-tip">
                    <i class="fas fa-lightbulb"></i> <strong>科学家提示：</strong> 完成所有三种植树问题的探索，可以获得"植树科学家"称号！
                </div>
            </div>
        </div>
        
        <footer>
            <p>植树问题科学探索园 | 像科学家一样思考，发现数学的乐趣！</p>
            <p>尝试不同的参数设置，观察植树规律的变化吧！</p>
        </footer>
    </div>

    <script>
        // 全局变量
        let currentProblemType = "both";
        let roadLength = 100;
        let intervalDistance = 10;
        let treeCount = 0;
        let score = 0;
        let achievements = ["植树新手"];
        let isMeasuring = false;
        
        // DOM元素
        const plantingArea = document.getElementById('planting-area');
        const treeCountElement = document.getElementById('tree-count');
        const roadLengthSlider = document.getElementById('road-length');
        const roadLengthValue = document.getElementById('road-length-value');
        const intervalSlider = document.getElementById('interval');
        const intervalValue = document.getElementById('interval-value');
        const plantTreesBtn = document.getElementById('plant-trees-btn');
        const formulaText = document.getElementById('formula-text');
        const intervalCountElement = document.getElementById('interval-count');
        const treeResultElement = document.getElementById('tree-result');
        const scoreElement = document.getElementById('score');
        const achievementsElement = document.getElementById('achievements');
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 设置事件监听器
            setupEventListeners();
            
            // 初始更新
            updateFormula();
            updateResults();
            
            // 显示初始成就
            updateAchievements();
        });
        
        // 设置事件监听器
        function setupEventListeners() {
            // 问题类型按钮
            document.querySelectorAll('.type-btn[data-type]').forEach(btn => {
                btn.addEventListener('click', function() {
                    // 移除所有按钮的active类
                    document.querySelectorAll('.type-btn[data-type]').forEach(b => {
                        b.classList.remove('active');
                    });
                    
                    // 给当前按钮添加active类
                    this.classList.add('active');
                    
                    // 更新问题类型
                    currentProblemType = this.getAttribute('data-type');
                    
                    // 更新公式
                    updateFormula();
                    
                    // 重新植树
                    plantTrees();
                });
            });
            
            // 路线长度滑块
            roadLengthSlider.addEventListener('input', function() {
                roadLength = parseInt(this.value);
                roadLengthValue.textContent = roadLength;
                updateFormula();
            });
            
            // 间隔距离滑块
            intervalSlider.addEventListener('input', function() {
                intervalDistance = parseInt(this.value);
                intervalValue.textContent = intervalDistance;
                updateFormula();
            });
            
            // 植树按钮
            plantTreesBtn.addEventListener('click', function() {
                plantTrees();
                this.classList.remove('pulse');
                
                // 增加分数
                score += 10;
                updateResults();
                
                // 检查成就
                checkAchievements();
            });
            
            // 工具区交互
            document.getElementById('tool-ruler').addEventListener('click', function() {
                toggleMeasuringTool();
            });
            
            document.getElementById('tool-calculator').addEventListener('click', function() {
                showCalculator();
            });
            
            document.getElementById('tool-notebook').addEventListener('click', function() {
                showNotebook();
            });
            
            document.getElementById('tool-magnifier').addEventListener('click', function() {
                highlightPattern();
            });
        }
        
        // 植树函数
        function plantTrees() {
            // 清空植树区域
            plantingArea.innerHTML = '';
            treeCount = 0;
            
            // 计算间隔数
            const intervalCount = Math.floor(roadLength / intervalDistance);
            
            // 根据问题类型计算植树数量
            let treesToPlant;
            switch(currentProblemType) {
                case "both":
                    treesToPlant = intervalCount + 1;
                    break;
                case "one":
                    treesToPlant = intervalCount;
                    break;
                case "none":
                    treesToPlant = intervalCount - 1;
                    break;
                default:
                    treesToPlant = 0;
            }
            
            // 确保植树数量不为负数
            treesToPlant = Math.max(0, treesToPlant);
            
            // 创建道路
            const road = document.createElement('div');
            road.className = 'road';
            road.style.width = '100%';
            road.style.bottom = '40%';
            plantingArea.appendChild(road);
            
            // 创建树
            for(let i = 0; i < treesToPlant; i++) {
                let position;
                
                // 根据问题类型确定位置
                switch(currentProblemType) {
                    case "both":
                        position = i * (100 / intervalCount);
                        break;
                    case "one":
                        position = i * (100 / intervalCount);
                        break;
                    case "none":
                        position = (i + 1) * (100 / (intervalCount + 1));
                        break;
                }
                
                createTree(position, i);
                treeCount++;
            }
            
            // 更新树计数显示
            treeCountElement.textContent = treeCount;
            
            // 更新结果
            updateResults();
            
            // 添加庆祝效果
            if (treeCount > 0) {
                plantingArea.classList.add('celebrate');
                setTimeout(() => {
                    plantingArea.classList.remove('celebrate');
                }, 500);
            }
        }
        
        // 创建树元素
        function createTree(positionPercent, index) {
            const tree = document.createElement('div');
            tree.className = 'tree';
            tree.style.left = `calc(${positionPercent}% - 20px)`;
            tree.style.bottom = '40%';
            tree.dataset.index = index;
            
            const trunk = document.createElement('div');
            trunk.className = 'tree-trunk';
            
            const crown = document.createElement('div');
            crown.className = 'tree-crown';
            
            tree.appendChild(crown);
            tree.appendChild(trunk);
            
            // 添加点击事件（用于测量工具）
            tree.addEventListener('click', function() {
                if (isMeasuring) {
                    measureTreeDistance(this);
                }
            });
            
            plantingArea.appendChild(tree);
        }
        
        // 更新公式显示
        function updateFormula() {
            const intervalCount = Math.floor(roadLength / intervalDistance);
            let formula, explanation;
            
            switch(currentProblemType) {
                case "both":
                    formula = `棵数 = 间隔数 + 1 = ${intervalCount} + 1 = ${intervalCount + 1}`;
                    explanation = "两端都栽：开头和结尾都植树";
                    break;
                case "one":
                    formula = `棵数 = 间隔数 = ${intervalCount}`;
                    explanation = "只栽一端：只在开头或结尾植树";
                    break;
                case "none":
                    const trees = Math.max(0, intervalCount - 1);
                    formula = `棵数 = 间隔数 - 1 = ${intervalCount} - 1 = ${trees}`;
                    explanation = "两端不栽：开头和结尾都不植树";
                    break;
            }
            
            formulaText.innerHTML = `<strong>${explanation}</strong><br>${formula}`;
        }
        
        // 更新结果展示
        function updateResults() {
            const intervalCount = Math.floor(roadLength / intervalDistance);
            
            intervalCountElement.textContent = intervalCount;
            treeResultElement.textContent = treeCount;
            scoreElement.textContent = score;
        }
        
        // 更新成就显示
        function updateAchievements() {
            achievementsElement.innerHTML = '';
            achievements.forEach(achievement => {
                const badge = document.createElement('span');
                badge.className = 'achievement-badge';
                badge.textContent = achievement;
                achievementsElement.appendChild(badge);
            });
        }
        
        // 检查成就
        function checkAchievements() {
            // 检查是否探索了所有问题类型
            if (!achievements.includes("多类型探索者") && score >= 30) {
                achievements.push("多类型探索者");
                updateAchievements();
            }
            
            // 检查是否种植了超过50棵树
            if (!achievements.includes("植树能手") && treeCount >= 50) {
                achievements.push("植树能手");
                updateAchievements();
            }
            
            // 检查是否获得了高分
            if (!achievements.includes("植树科学家") && score >= 100) {
                achievements.push("植树科学家");
                updateAchievements();
                
                // 庆祝效果
                document.querySelector('h1').classList.add('celebrate');
                setTimeout(() => {
                    document.querySelector('h1').classList.remove('celebrate');
                }, 1000);
            }
        }
        
        // 测量工具
        function toggleMeasuringTool() {
            isMeasuring = !isMeasuring;
            const toolRuler = document.getElementById('tool-ruler');
            
            if (isMeasuring) {
                toolRuler.style.backgroundColor = '#bbdefb';
                toolRuler.innerHTML = '<h3><i class="fas fa-ruler"></i> 间隔测量器 (激活中)</h3><p>点击两棵树测量间隔距离</p>';
                
                // 显示提示
                showMessage("点击两棵树来测量它们之间的间隔距离", "info");
            } else {
                toolRuler.style.backgroundColor = '';
                toolRuler.innerHTML = '<h3><i class="fas fa-ruler"></i> 间隔测量器</h3><p>点击测量两个树之间的间隔距离</p>';
                
                // 清除所有测量线
                document.querySelectorAll('.measure-line').forEach(el => el.remove());
                document.querySelectorAll('.measure-label').forEach(el => el.remove());
            }
        }
        
        let firstTreeForMeasurement = null;
        
        function measureTreeDistance(treeElement) {
            if (!firstTreeForMeasurement) {
                firstTreeForMeasurement = treeElement;
                treeElement.style.boxShadow = '0 0 0 3px blue';
                showMessage("现在点击第二棵树", "info");
            } else {
                // 获取两棵树的位置
                const rect1 = firstTreeForMeasurement.getBoundingClientRect();
                const rect2 = treeElement.getBoundingClientRect();
                
                // 计算距离
                const distancePx = Math.abs(rect1.left - rect2.left);
                const distanceMeters = Math.round((distancePx / plantingArea.offsetWidth) * roadLength);
                
                // 创建测量线
                createMeasureLine(firstTreeForMeasurement, treeElement, distanceMeters);
                
                // 重置
                firstTreeForMeasurement.style.boxShadow = '';
                firstTreeForMeasurement = null;
                
                showMessage(`两棵树之间的间隔距离是 ${distanceMeters} 米`, "success");
            }
        }
        
        function createMeasureLine(tree1, tree2, distance) {
            // 获取位置
            const rect1 = tree1.getBoundingClientRect();
            const rect2 = tree2.getBoundingClientRect();
            const containerRect = plantingArea.getBoundingClientRect();
            
            // 计算线的位置
            const left = Math.min(rect1.left, rect2.left) - containerRect.left + 20;
            const top = containerRect.height * 0.6;
            const width = Math.abs(rect1.left - rect2.left);
            
            // 创建线
            const line = document.createElement('div');
            line.className = 'measure-line';
            line.style.position = 'absolute';
            line.style.left = `${left}px`;
            line.style.top = `${top}px`;
            line.style.width = `${width}px`;
            line.style.height = '2px';
            line.style.backgroundColor = 'red';
            line.style.zIndex = '5';
            
            // 创建标签
            const label = document.createElement('div');
            label.className = 'measure-label';
            label.style.position = 'absolute';
            label.style.left = `${left + width/2}px`;
            label.style.top = `${top - 25}px`;
            label.style.transform = 'translateX(-50%)';
            label.style.backgroundColor = 'white';
            label.style.padding = '2px 8px';
            label.style.borderRadius = '10px';
            label.style.border = '2px solid red';
            label.style.fontWeight = 'bold';
            label.style.color = 'red';
            label.style.zIndex = '5';
            label.textContent = `${distance}米`;
            
            plantingArea.appendChild(line);
            plantingArea.appendChild(label);
        }
        
        // 计算器工具
        function showCalculator() {
            const roadLengthInput = prompt("请输入路线长度（米）：", roadLength);
            const intervalInput = prompt("请输入间隔距离（米）：", intervalDistance);
            
            if (roadLengthInput && intervalInput) {
                const length = parseInt(roadLengthInput);
                const interval = parseInt(intervalInput);
                
                if (length > 0 && interval > 0) {
                    const intervalCount = Math.floor(length / interval);
                    const bothTrees = intervalCount + 1;
                    const oneTree = intervalCount;
                    const noneTrees = Math.max(0, intervalCount - 1);
                    
                    const result = `
                    路线长度：${length}米
                    间隔距离：${interval}米
                    间隔数：${intervalCount}
                    
                    两端都栽：${bothTrees}棵树
                    只栽一端：${oneTree}棵树
                    两端不栽：${noneTrees}棵树
                    `;
                    
                    alert(result);
                } else {
                    alert("请输入有效的正数！");
                }
            }
        }
        
        // 笔记本工具
        function showNotebook() {
            const notes = `
=== 植树问题科学观察笔记 ===

发现规律：
1. 两端都栽：树的棵数比间隔数多1
2. 只栽一端：树的棵数等于间隔数
3. 两端不栽：树的棵数比间隔数少1

公式总结：
• 间隔数 = 路线长度 ÷ 间隔距离
• 棵数 = 间隔数 + 1 (两端都栽)
• 棵数 = 间隔数 (只栽一端)
• 棵数 = 间隔数 - 1 (两端不栽)

我的发现：
________________________________
________________________________
________________________________

            `;
            
            alert(notes);
        }
        
        // 规律放大镜
        function highlightPattern() {
            const trees = document.querySelectorAll('.tree');
            
            // 交替高亮树
            trees.forEach((tree, index) => {
                setTimeout(() => {
                    tree.style.boxShadow = '0 0 0 3px yellow';
                    
                    // 3秒后移除高亮
                    setTimeout(() => {
                        tree.style.boxShadow = '';
                    }, 3000);
                }, index * 200);
            });
            
            showMessage("观察植树规律：树与树之间的间隔是相等的！", "info");
        }
        
        // 显示消息
        function showMessage(message, type) {
            // 移除已有的消息
            const existingMessage = document.querySelector('.message-box');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            // 创建消息框
            const messageBox = document.createElement('div');
            messageBox.className = `message-box ${type}`;
            messageBox.style.position = 'fixed';
            messageBox.style.top = '20px';
            messageBox.style.right = '20px';
            messageBox.style.backgroundColor = type === 'info' ? '#e1f5fe' : '#e8f5e9';
            messageBox.style.borderLeft = `5px solid ${type === 'info' ? '#03a9f4' : '#4caf50'}`;
            messageBox.style.padding = '15px';
            messageBox.style.borderRadius = '10px';
            messageBox.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
            messageBox.style.zIndex = '1000';
            messageBox.style.maxWidth = '300px';
            messageBox.innerHTML = `<strong>${type === 'info' ? '提示' : '成功'}:</strong> ${message}`;
            
            document.body.appendChild(messageBox);
            
            // 5秒后自动移除
            setTimeout(() => {
                if (messageBox.parentNode) {
                    messageBox.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>